

### 什么是graphRAG

**RAG**是一种 AI 框架，它将传统信息检索系统（例如数据库）的优势与生成式大语言模型 (LLM) 的功能结合在一起。（检索，生成）

简单来说就是将我们自己的数据构建成储存信息的知识库，将我们的问题在知识库进行查询，将查到的知识和问题一同交给大模型，让大模型给我们生成结果

此外，RAG的检索方式是相似度匹配，匹配文本之间是否相近。

GraphRAG 是 RAG 的高级版本，在许多地方有了改进，比如存储的数据格式，构建数据库的算法，检索的算法都有了变化。



## GraphRAG解决了什么问题

当你问：“这个文章的主题是什么？”这类高级别、概括性的问题时，传统的RAG可能就会束手无策。为什么呢？那是因为这本质上是一个聚焦于查询的总结性任务，而不是一个明确的检索任务。



### 它有哪些优点

GraphRAG能够更精确地检索和生成与上下文相关的响应。同时能检索更多相关性和总结性的信息，回答总结性的问题



### 它是如何运行的

由于GraphRAG是RAG的改进，所以它继承了原有的运行过程

包括三个步骤：

#### 1.构建知识库（基于图的索引）：

RAG：将数据转为统一格式(文本数据)，数据切块，向量化存储

GraphRAG：利用LLM从数据中提取实体以及实体关系；转变为图结构信息，再利用算法将每个节点分类，将关系相近的节点划分为一类（社区）（社区检测算法），最后，为每个类（社区）总结出一个关键词

![](C:\Users\20884\Pictures\Saved Pictures\89ec93230dc22f02fce2b7eb9ca072e1.png)

**图结构信息**是指将数据表示为图（Graph）的形式，人物等事物(节点)与它们之间的关系

图结构可以非常直观地表示复杂的关系网络。

1. **丰富的语义关系**：
   - **图结构**能够捕捉到实体之间的多种关系，而不仅仅是文本中的共现信息。例如，通过图结构，可以明确知道某个人物是另一个角色的朋友还是敌人，这比单纯的关键词匹配提供了更多的上下文信息。
   - 这种丰富的语义关系使得系统能够更准确地理解查询的意图，并找到最相关的节点和边。
2. **路径和连接性**：
   - 在图结构中，可以通过路径（Path）来查找从一个节点到另一个节点的多步关系。例如，查询 “谁是 Scrooge 的朋友的朋友？” 时，图结构可以直接通过边的连接找到答案。
   - 路径和连接性的使用使得系统能够在复杂的关联中进行推理，从而提供更精确的结果。

#### 2.检索数据(图引导检索)：

RAG：将问题向量化，在知识库中进行相似度匹配。之后知识库将返回与问题相似的数据

GraphRAG：将问题转换为图结构，在图结构知识库中进行查询，但是是新的方式：MAP—reduce，其中，检索是MAP部分

然后返回对应数据



MAP—reduce：

#### Map 阶段

- **并行执行查询**：针对用户的查询需求，在所有社区上并行执行搜索操作（检索每个社区中与问题相关的信息），即在每个社区内查找与问题相关的信息。
- 根据问题的具体内容，计算问题与社区摘要之间的关联程度。
- **植物5，电子器具10**
- 苹果10，手机10，显示屏6
- 苹果50，手机100，显示屏60
- 手机，显示屏

#### Reduce 阶段

- **结果聚合与综合**：收集各社区返回的相关信息，根据之前计算出的关联程度，为每个社区中搜索到的信息进行排序，返回最相近的那些信息

#### 3.增强生成(图增强生成)：

RAG/GraphRAG：将信息和问题合并，交由大模型生成对应的回答



### 它有什么缺点呢

图结构信息的搜索方式为：根据算法不同，匹配社区中某一个节点或者多个节点，进行相似度匹配，匹配成功时，将所有和这个节点有关系的节点继续这一步骤

#### 多轮检索过程

- **迭代查询机制**：为了准确地找到相关联的信息片段，GraphRAG 可能需要执行多次查询操作，并且每次查询的结果都可能需要作为新的输入返回给模型进一步处理。这种反复的过程会增加整体使用的 token 数量。
- **动态路径选择**：当试图沿着不同的关系路径探索时，每条探索路径都会产生额外的令牌消耗。尽管有些路径最终可能不会被选中用于最终答案生成，但探索本身就已经产生了成本。比如说多个节点互相关联，不同路径查询到同一节点。